(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{341:function(t,a,s){t.exports=s.p+"assets/img/pisp_dcu.c90299ae.png"},342:function(t,a,s){t.exports=s.p+"assets/img/pisp_dcu_done.8d748930.png"},343:function(t,a,s){t.exports=s.p+"assets/img/pisp_callback.8ea3cce2.png"},344:function(t,a,s){t.exports=s.p+"assets/img/pisp_lookup.438b3046.png"},345:function(t,a,s){t.exports=s.p+"assets/img/pisp_put_auth.b0d3bd41.png"},405:function(t,a,s){"use strict";s.r(a);var e=s(42),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"trying-out-the-thirdparty-api-locally"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#trying-out-the-thirdparty-api-locally"}},[t._v("#")]),t._v(" Trying out the Thirdparty API Locally")]),t._v(" "),e("p",[t._v("The Thirdparty API (PISP API) is still in preview mode, but that doesn't mean you can't use it to build against!")]),t._v(" "),e("p",[t._v("This guide walks you through how to run the testing toolkit locally to support the Thirdparty API.")]),t._v(" "),e("h2",{attrs:{id:"prerequisites"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#prerequisites"}},[t._v("#")]),t._v(" Prerequisites")]),t._v(" "),e("ul",[e("li",[t._v("Command line access on a machine")]),t._v(" "),e("li",[t._v("A Browser")]),t._v(" "),e("li",[e("code",[t._v("docker")]),t._v(" and "),e("code",[t._v("docker-compose")]),t._v(", any recent version should work")])]),t._v(" "),e("h2",{attrs:{id:"_1-download-the-ttk-config-from-the-thirdparty-scheme-adapter-repo"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-download-the-ttk-config-from-the-thirdparty-scheme-adapter-repo"}},[t._v("#")]),t._v(" 1. Download the TTK Config from the thirdparty-scheme-adapter repo")]),t._v(" "),e("p",[t._v("Go to "),e("a",{attrs:{href:"https://github.com/mojaloop/thirdparty-scheme-adapter",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/mojaloop/thirdparty-scheme-adapter"),e("OutboundLink")],1),t._v(". This is where a lot of the in progress work for pisp is taking place.")]),t._v(" "),e("p",[t._v("Clone the repo however you'd like, for example:")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/mojaloop/thirdparty-scheme-adapter.git\n")])])]),e("p",[t._v("Once that is complete, cd into the "),e("code",[t._v("./docker/contract")]),t._v(" directory")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ./docker/contract\n")])])]),e("h2",{attrs:{id:"_2-run-docker-compose-up"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-run-docker-compose-up"}},[t._v("#")]),t._v(" 2. Run "),e("code",[t._v("docker-compose up")])]),t._v(" "),e("p",[t._v("In this folder, we maintain a pre-configured testing toolkit that supports the PISP APIs that we run tests against.")]),t._v(" "),e("p",[t._v("Start the containers like so")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("docker-compose up\n")])])]),e("p",[e("img",{attrs:{src:s(341),alt:""}})]),t._v(" "),e("p",[t._v("And wait for docker to download and run the containers. This may take a little while depending on your connection speed.")]),t._v(" "),e("p",[t._v("You should see some output similar to the following:")]),t._v(" "),e("p",[e("img",{attrs:{src:s(342),alt:""}})]),t._v(" "),e("h2",{attrs:{id:"_3-browse-the-locally-running-testing-toolkit"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-browse-the-locally-running-testing-toolkit"}},[t._v("#")]),t._v(" 3. Browse the Locally Running Testing Toolkit")]),t._v(" "),e("p",[t._v("The Testing Toolkit UI will be up and running at "),e("a",{attrs:{href:"http://localhost:6060",target:"_blank",rel:"noopener noreferrer"}},[t._v("localhost:6060"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v('Go to the "monitoring" tab to watch the requests as they come in.')]),t._v(" "),e("h2",{attrs:{id:"_4-configure-a-callback-server"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-configure-a-callback-server"}},[t._v("#")]),t._v(" 4. Configure a callback server")]),t._v(" "),e("p",[t._v("We a way to inspect the callbacks from the Testing Toolkit. In your production app, this would be pointed to your application, but for this example we can just log the requests.")]),t._v(" "),e("p",[t._v("We can use docker to run a simple web server which prints out its inbound requests.")]),t._v(" "),e("p",[t._v("Open "),e("code",[t._v("docker-compose.yml")]),t._v(", and add a new service on line "),e("code",[t._v("8")]),t._v(":")]),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("...")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("callback-server")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mendhak/http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("https"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("echo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("networks")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" mojaloop"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("pisp"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("net\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 8081"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("8080")]),t._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ml-testing-toolkit")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mojaloop/ml"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("testing"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("toolkit"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("v11.2.2\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("...")]),t._v("\n\n")])])]),e("p",[t._v("Save and close the file, and restart your docker-compose:")]),t._v(" "),e("p",[e("code",[t._v("docker-compose up")])]),t._v(" "),e("p",[t._v("You can check the logs for the "),e("code",[t._v("callback-server")]),t._v(" in a separate window with the following command:")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("docker-compose logs -f callback-server \n")])])]),e("p",[t._v("Now we need to confgure the testing toolkit to use the correct callback url.")]),t._v(" "),e("p",[t._v("Go to "),e("a",{attrs:{href:"http://localhost:6060/admin/settings",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("localhost:6060/admin/settings")]),e("OutboundLink")],1),t._v(" and look for the "),e("code",[t._v("Callback URL")]),t._v(" field.")]),t._v(" "),e("p",[t._v("Change this to "),e("code",[t._v("http://callback-server:8080")]),t._v(".")]),t._v(" "),e("p",[t._v('Next, untick the "Enable Callback resource endpoints" box, and hit "Save"')]),t._v(" "),e("p",[e("img",{attrs:{src:s(343),alt:""}})]),t._v(" "),e("h2",{attrs:{id:"_5-call-the-thirdparty-apis"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-call-the-thirdparty-apis"}},[t._v("#")]),t._v(" 5. Call the Thirdparty APIs!")]),t._v(" "),e("p",[t._v("You can now start using the Thirdparty APIs")]),t._v(" "),e("p",[t._v("The API is divided into 2 sections:")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"http://beta.moja-lab.live/2-apis/thirdparty-pisp.html",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("Thirdparty-PISP")]),e("OutboundLink")],1),t._v(" for the PISP side of the transaction")]),t._v(" "),e("li",[e("a",{attrs:{href:"http://beta.moja-lab.live/2-apis/thirdparty-dfsp.html",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("Thirdparty-DFSP")]),e("OutboundLink")],1),t._v(" for an existing DFSP to support PISP's features")])]),t._v(" "),e("p",[t._v("To start with, you most likely will want to be using the "),e("code",[t._v("Thirdparty-PISP")]),t._v(" API.")]),t._v(" "),e("p",[t._v("To understand how a PISP tranfer works, check out the "),e("a",{attrs:{href:"https://github.com/mojaloop/pisp/blob/master/docs/transfer/README.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("PISP Transfer documentation here"),e("OutboundLink")],1)]),t._v(" "),e("h3",{attrs:{id:"_5-1-party-lookup"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-party-lookup"}},[t._v("#")]),t._v(" 5.1 Party Lookup:")]),t._v(" "),e("p",[e("img",{attrs:{src:s(344),alt:""}})]),t._v(" "),e("p",[t._v("In this step, the PISP asks Mojaloop to look up the payee party that their user wants to send to.")]),t._v(" "),e("ul",[e("li",[t._v("Request: "),e("code",[t._v("GET /parties/{Type}/{ID}")])]),t._v(" "),e("li",[t._v("Async Callback: "),e("code",[t._v("PUT /parties/{Type}/{ID}")])])]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -X GET http://localhost:15000/parties/MSISDN/12345 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Accept: application/vnd.interoperability.parties+json;version=1.0'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type: application/vnd.interoperability.parties+json;version=1.0'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Date: Mon, 11 Jan 2021 00:00:00 GMT'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'FSPIOP-Source: pispa'")]),t._v("\n")])])]),e("p",[t._v("Example Logs in "),e("code",[t._v("callback-server")]),t._v(":")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('-----------------\n{\n    "path": "/parties/MSISDN/12345",\n    "headers": {\n        "content-type": "application/vnd.interoperability.parties+json;version=1.0",\n        "date": "Wed, 27 May 2020 11:13:34 GMT",\n        "x-forwarded-for": "sed eiusmod sunt",\n        "fspiop-source": "pisp",\n        "fspiop-destination": "dfspa",\n        "fspiop-encryption": "magna Excepteur dolore nisi fugiat",\n        "fspiop-signature": "nisi",\n        "fspiop-uri": "veniam reprehenderit anim ut",\n        "fspiop-http-method": "PUT",\n        "content-length": "276",\n        "traceparent": "00-ccddd97c01d76f8345331389690b33-0123456789abcdef0-00",\n        "user-agent": "axios/0.19.2",\n        "host": "callback-server:8080",\n        "connection": "close"\n    },\n    "method": "PUT",\n    "body": "{\\"party\\":{\\"partyIdInfo\\":{\\"partyIdType\\":\\"MSISDN\\",\\"partyIdentifier\\":\\"12345\\",\\"fspId\\":\\"pispA\\"},\\"merchantClassificationCode\\":\\"4321\\",\\"name\\":\\"Justin Trudeau\\",\\"personalInfo\\":{\\"complexName\\":{\\"firstName\\":\\"Justin\\",\\"middleName\\":\\"Pierre\\",\\"lastName\\":\\"Trudeau\\"},\\"dateOfBirth\\":\\"1980-01-01\\"}}}",\n    "fresh": false,\n    "hostname": "callback-server",\n    "ip": "sed eiusmod sunt",\n    "ips": [\n        "sed eiusmod sunt"\n    ],\n    "protocol": "http",\n    "query": {},\n    "subdomains": [],\n    "xhr": false,\n    "os": {\n        "hostname": "18409aa1c315"\n    },\n    "connection": {}\n}\nsed eiusmod sunt - - [15/Jan/2021:10:34:20 +0000] "PUT /parties/MSISDN/12345 HTTP/1.1" 200 1280 "-" "axios/0.19.2"\n\n')])])]),e("h3",{attrs:{id:"_5-2-post-thirdpartyrequests-transactions"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-post-thirdpartyrequests-transactions"}},[t._v("#")]),t._v(" 5.2 "),e("code",[t._v("POST /thirdpartyRequests/transactions")])]),t._v(" "),e("p",[t._v("In this step, the PISP asks the DFSP to get a quote that it can")]),t._v(" "),e("ol",[e("li",[t._v("Display to their user")]),t._v(" "),e("li",[t._v("Get the user to sign using a private key residing on their device")])]),t._v(" "),e("ul",[e("li",[t._v("Request: "),e("code",[t._v("POST /thirdpartyRequests/transactions")])]),t._v(" "),e("li",[t._v("Async Callback: "),e("code",[t._v("POST /authorizations")])])]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -X POST http://localhost:15000/thirdpartyRequests/transactions "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Accept: application/vnd.thirdparty.transactions+json;version=1.0'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type: application/vnd.thirdparty.transactions+json;version=1.0'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Date: Mon, 11 Jan 2021 00:00:00 GMT'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'FSPIOP-Source: pispa'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'FSPIOP-Destination: dfspa'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -d "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{\n  "sourceAccountId": "mats_account.dfspa.123",\n  "consentId": "387ee6b9-520d-4c51-a9e4-6eb2ef15123a",\n  "transactionRequestId": "387ee6b9-520d-4c51-a9e4-6eb2ef15887a",\n  "payer": {\n    "partyIdInfo": {\n      "partyIdType": "MSISDN",\n      "partyIdentifier": "947947947947",\n      "fspId": "applebank"\n    },\n    "personalInfo": {\n      "complexName": {\n        "firstName": "Mats",\n        "lastName": "Hagman"\n      },\n      "dateOfBirth": "1983-10-25"\n    }\n  },\n  "payee": {\n    "partyIdInfo": {\n      "partyIdType": "MSISDN",\n      "partyIdentifier": "27713803912",\n      "fspId": "payeefsp"\n    }\n  },\n  "amountType": "SEND",\n  "amount": {\n    "amount": "10",\n    "currency": "USD"\n  },\n  "transactionType": {\n    "scenario": "TRANSFER",\n    "initiator": "PAYER",\n    "initiatorType": "CONSUMER"\n  },\n  "expiration": "2021-01-30T00:00:00.000"\n}\'')]),t._v("\n")])])]),e("p",[t._v("Example Response (in "),e("code",[t._v("docker-compose logs -f callback-server")]),t._v(")")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('{\n    "path": "/authorizations",\n    "headers": {\n        "content-type": "application/vnd.interoperability.authorizations+json;version=1.0",\n        "accept": "application/vnd.interoperability.authorizations+json;version=1.0",\n        "date": "Wed, 27 May 2020 11:13:34 GMT",\n        "fspiop-source": "DFSPA",\n        "traceparent": "00-ccdd87fbd24d7dfc42d7b58e059dcc-0123456789abcdef0-00",\n        "user-agent": "axios/0.19.2",\n        "content-length": "775",\n        "host": "callback-server:8080",\n        "connection": "close"\n    },\n    "method": "POST",\n    "body": "{\\"authenticationType\\":\\"U2F\\",\\"retriesLeft\\":\\"1\\",\\"amount\\":{\\"currency\\":\\"USD\\",\\"amount\\":\\"124.45\\"},\\"transactionId\\":\\"2f169631-ef99-4cb1-96dc-91e8fc08f539\\",\\"transactionRequestId\\":\\"387ee6b9-520d-4c51-a9e4-6eb2ef15887a\\",\\"quote\\":{\\"transferAmount\\":{\\"currency\\":\\"USD\\",\\"amount\\":\\"124.45\\"},\\"payeeReceiveAmount\\":{\\"currency\\":\\"USD\\",\\"amount\\":\\"123.45\\"},\\"payeeFspFee\\":{\\"currency\\":\\"USD\\",\\"amount\\":\\"1\\"},\\"payeeFspCommission\\":{\\"currency\\":\\"USD\\",\\"amount\\":\\"0\\"},\\"expiration\\":\\"2020-08-24T08:38:08.699-04:00\\",\\"geoCode\\":{\\"latitude\\":\\"+45.4215\\",\\"longitude\\":\\"+75.6972\\"},\\"ilpPacket\\":\\"AYIBgQAAAAAAAASwNGxldmVsb25lLmRmc3AxLm1lci45T2RTOF81MDdqUUZ\\",\\"condition\\":\\"f5sqb7tBTWPd5Y8BDFdMm9BJR_MNI4isf8p8n4D5pHA\\",\\"extensionList\\":{\\"extension\\":[{\\"key\\":\\"errorDescription\\",\\"value\\":\\"This is a more detailed error description\\"}]}}}",\n    "fresh": false,\n    "hostname": "callback-server",\n    "ip": "::ffff:172.21.0.2",\n    "ips": [],\n    "protocol": "http",\n    "query": {},\n    "subdomains": [],\n    "xhr": false,\n    "os": {\n        "hostname": "18409aa1c315"\n    },\n    "connection": {}\n}\n')])])]),e("p",[t._v("Example Body (parsed from the above response):")]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"authenticationType"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"U2F"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"retriesLeft"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"amount"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"currency"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"USD"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"amount"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"124.45"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"transactionId"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2f169631-ef99-4cb1-96dc-91e8fc08f539"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"transactionRequestId"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"387ee6b9-520d-4c51-a9e4-6eb2ef15887a"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"quote"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"transferAmount"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"currency"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"USD"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"amount"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"124.45"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"payeeReceiveAmount"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"currency"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"USD"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"amount"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"123.45"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"payeeFspFee"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"currency"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"USD"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"amount"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"payeeFspCommission"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"currency"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"USD"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"amount"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"expiration"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2020-08-24T08:38:08.699-04:00"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"geoCode"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"latitude"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"+45.4215"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"longitude"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"+75.6972"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ilpPacket"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"AYIBgQAAAAAAAASwNGxldmVsb25lLmRmc3AxLm1lci45T2RTOF81MDdqUUZ"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"condition"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"f5sqb7tBTWPd5Y8BDFdMm9BJR_MNI4isf8p8n4D5pHA"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"extensionList"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"extension"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token null keyword"}},[t._v("null")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("You can see that the DFSP has issues the "),e("code",[t._v("POST /authorizations")]),t._v(" to the PISP containing a Quote they can display to their end user.")]),t._v(" "),e("h3",{attrs:{id:"_5-3-put-authorizations-id"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-put-authorizations-id"}},[t._v("#")]),t._v(" 5.3 "),e("code",[t._v("PUT/authorizations/{ID}")])]),t._v(" "),e("p",[e("img",{attrs:{src:s(345),alt:""}})]),t._v(" "),e("p",[t._v("In this step, the PISP presents the quote to the user and asks them to sign it using the private key on their device. The PISP then sends this signed quote to the DFSP, who checks it, and if it approves, conducts the transfer.")]),t._v(" "),e("ul",[e("li",[t._v("Request: "),e("code",[t._v("PUT /authorizations/123")])]),t._v(" "),e("li",[t._v("Async Callback: "),e("code",[t._v("PATCH /thirdpartyRequests/transactions/123")])])]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -X PUT http://localhost:15000/authorizations/123 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Accept: application/vnd.interoperability.thirdparty+json;version=1.0'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type: application/vnd.interoperability.thirdparty+json;version=1.0'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Date: Mon, 11 Jan 2021 00:00:00 GMT'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'FSPIOP-Source: pispa'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'FSPIOP-Destination: dfspa'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -d "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{\n        "authenticationInfo": {\n          "authentication": "U2F",\n          "authenticationValue":{\n            "pinValue": "aaabbbcccddd",\n            "counter": "1"\n          }\n        },\n        "responseType": "ENTERED"\n      }\'')]),t._v("\n")])])]),e("p",[t._v("Callback Response from TTK")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('callback-server_1        | {\ncallback-server_1        |     "path": "/thirdpartyRequests/transactions/123",\ncallback-server_1        |     "headers": {\ncallback-server_1        |         "content-type": "application/vnd.interoperability.thirdparty+json;version=1.0",\ncallback-server_1        |         "fspiop-source": "switch",\ncallback-server_1        |         "accept": "application/vnd.interoperability.thirdparty+json;version=1.0",\ncallback-server_1        |         "date": "Fri, 15 Jan 2021 12:54:53 GMT",\ncallback-server_1        |         "user-agent": "axios/0.19.2",\ncallback-server_1        |         "content-length": "93",\ncallback-server_1        |         "host": "callback-server:8080",\ncallback-server_1        |         "connection": "close"\ncallback-server_1        |     },\ncallback-server_1        |     "method": "PATCH",\ncallback-server_1        |     "body": "{\\"transactionId\\":\\"b51ec534-ee48-4575-b6a9-ead2955b8069\\",\\"transactionRequestState\\":\\"ACCEPTED\\"}",\ncallback-server_1        |     "fresh": false,\ncallback-server_1        |     "hostname": "callback-server",\ncallback-server_1        |     "ip": "::ffff:172.21.0.4",\ncallback-server_1        |     "ips": [],\ncallback-server_1        |     "protocol": "http",\ncallback-server_1        |     "query": {},\ncallback-server_1        |     "subdomains": [],\ncallback-server_1        |     "xhr": false,\ncallback-server_1        |     "os": {\ncallback-server_1        |         "hostname": "18409aa1c315"\ncallback-server_1        |     },\ncallback-server_1        |     "connection": {}\ncallback-server_1        | }\n')])])]),e("p",[t._v("parsed message")]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"transactionId"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"b51ec534-ee48-4575-b6a9-ead2955b8069"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"transactionRequestState"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ACCEPTED"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("This means that the Thirdparty transactionRequest "),e("code",[t._v("123")]),t._v(" was completed sucessfully!")])])}),[],!1,null,null,null);a.default=n.exports}}]);