(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{360:function(t,a,e){"use strict";e.r(a);var s=e(42),n=Object(s.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"_1-dfsp-setup"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-dfsp-setup"}},[t._v("#")]),t._v(" 1. DFSP Setup")]),t._v(" "),e("p",[t._v("This guide will help you set up your own bare-bones DFSP server to send and receive Mojaloop requests using Mojaloop's "),e("RouterLink",{attrs:{to:"/2-apis/fspiop/"}},[t._v("FSPIOP API")])],1),t._v(" "),e("h2",{attrs:{id:"_1-prerequisites"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-prerequisites"}},[t._v("#")]),t._v(" 1. Prerequisites:")]),t._v(" "),e("ul",[e("li",[t._v("A "),e("code",[t._v("DFSP_ID")]),t._v(", you can make up any set of strings you would like, e.g. "),e("code",[t._v("lewsdfsp")])]),t._v(" "),e("li",[e("code",[t._v("node")]),t._v(", "),e("code",[t._v("npm")]),t._v(" and "),e("code",[t._v("npx")])]),t._v(" "),e("li",[e("code",[t._v("jq")])]),t._v(" "),e("li",[e("code",[t._v("docker")])])]),t._v(" "),e("blockquote",[e("p",[t._v("Does this guide look too command line heavy for you? Try using the "),e("RouterLink",{attrs:{to:"/3-guides/5_ttk_p2p/"}},[t._v("Testing Toolkit")]),t._v(" instead.")],1)]),t._v(" "),e("h2",{attrs:{id:"_2-run-a-mock-server-to-listen-to-async-callbacks"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-run-a-mock-server-to-listen-to-async-callbacks"}},[t._v("#")]),t._v(" 2. Run a Mock server to listen to async callbacks")]),t._v(" "),e("p",[t._v("Since Mojaloop is an Async API, we need to run a server to listen to callbacks from the Mojaloop Switch.")]),t._v(" "),e("p",[t._v("We use docker here to run a simple web server which prints out it's inbound requests.")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("docker run -p "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("8081")]),t._v(":8080 --rm -t mendhak/http-https-echo:15\n")])])]),e("p",[t._v("Once this server is up and running, you can test it out with the following:")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -X POST localhost:8081 -d "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{"hello":"world"}\'')]),t._v("\n")])])]),e("p",[t._v("You should see the following output in the docker window:")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('-----------------\n{\n    "path": "/",\n    "headers": {\n        "host": "localhost:8081",\n        "user-agent": "curl/7.74.0",\n        "accept": "*/*",\n        "content-length": "17",\n        "content-type": "application/x-www-form-urlencoded"\n    },\n    "method": "POST",\n    "body": "{\\"hello\\":\\"world\\"}",\n    "fresh": false,\n    "hostname": "localhost",\n    "ip": "::ffff:172.17.0.1",\n    "ips": [],\n    "protocol": "http",\n    "query": {},\n    "subdomains": [],\n    "xhr": false,\n    "os": {\n        "hostname": "4b1664b116cf"\n    },\n    "connection": {}\n}\n::ffff:172.17.0.1 - - [08/Jan/2021:00:11:59 +0000] "POST / HTTP/1.1" 200 486 "-" "curl/7.74.0"\n')])])]),e("p",[t._v("Once you are satisfied that the docker server is running, you can then use localtunnel to expose your mock server to the public internet:")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("npx localtunnel --port "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("8081")]),t._v(" --print-requests\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# prints the following output:")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  npx: installed 35 in 2.908s")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  your url is: https://thin-mole-36.loca.lt")]),t._v("\n")])])]),e("p",[t._v("In this case, my URL is "),e("code",[t._v("https://thin-mole-36.loca.lt")]),t._v(". For the rest of this example, I will refer to this by the environment variable "),e("code",[t._v("MOCK_SERVER_URL")])]),t._v(" "),e("p",[t._v("We can now test that our localtunnel is up and running, and that we can reach the docker container with the following:")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("MOCK_SERVER_URL")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("https://thin-mole-36.loca.lt "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# or whatever your localtunnel prints out")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -X POST "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${MOCK_SERVER_URL}")]),t._v(" -d "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{"hello":"world"}\'')]),t._v("\n")])])]),e("p",[t._v("Once again you should see some logging in the docker container.")]),t._v(" "),e("h2",{attrs:{id:"_3-create-a-new-dfsp-using-the-admin-api"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-create-a-new-dfsp-using-the-admin-api"}},[t._v("#")]),t._v(" 3. Create a new DFSP using the Admin API")]),t._v(" "),e("p",[t._v("Now that we have a server ready to listen to callbacks from the Mojaloop Switch, we can go ahead and register our new DFSP.")]),t._v(" "),e("p",[t._v("For this purpose we use the "),e("RouterLink",{attrs:{to:"/2-apis/admin/"}},[t._v("Admin API")]),t._v(", which is for Mojaloop Hub Operators and DFSPs.")],1),t._v(" "),e("p",[t._v("In this example I will use a "),e("code",[t._v("DFSP_ID")]),t._v(" of "),e("code",[t._v("lewbank")]),t._v(", but you should replace this with a "),e("code",[t._v("DFSP_ID")]),t._v(" of your choosing.")]),t._v(" "),e("blockquote",[e("p",[e("strong",[t._v("A note about security:")]),e("br"),t._v("\nFor the sake of this sandbox environment, we have not installed many of the security measures required for a production-grade deployment.\nThis Admin API will typically be only accessed by a privileged administrator of the Mojaloop Switch, with the appropriate security measures\nto stop nefarious behavor.")])]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# create a new participant with a currency of USD")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -X POST http://beta.moja-lab.live/api/admin/central-ledger/participants "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type: application/json'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    -d "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{"name":"lewbank", "currency":"USD"}\'')]),t._v("\n")])])]),e("h2",{attrs:{id:"_4-fund-the-dfsp-s-accounts"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-fund-the-dfsp-s-accounts"}},[t._v("#")]),t._v(" 4. Fund the DFSP's accounts")]),t._v(" "),e("p",[t._v("Now that our DFSP has been created, we need to set up its internal accounts.")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Set the initial position, and net debit cap")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -X POST http://beta.moja-lab.live/api/admin/central-ledger/participants/lewbank/initialPositionAndLimits "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type: application/json'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    -d "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{"currency":"USD", "limit": {"type":"NET_DEBIT_CAP", "value": 10000}, "initialPosition": 0}\'')]),t._v("\n")])])]),e("p",[t._v("We can then get the "),e("code",[t._v("settlementAccountId")])]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type: application/json'")]),t._v(" http://beta.moja-lab.live/api/admin/central-ledger/participants/lewbank "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" jq\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# output:")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# {")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#   "name": "lewbank",')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#   "id": "dev2-central-ledger.mojaloop.live/participants/lewbank",')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#   "created": "\\"2021-01-08T05:59:57.000Z\\"",')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#   "isActive": 1,')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#   "links": {')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#     "self": "dev2-central-ledger.mojaloop.live/participants/lewbank"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#   },")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#   "accounts": [')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#     {")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#       "id": 17,')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#       "ledgerAccountType": "POSITION",')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#       "currency": "USD",')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#       "isActive": 1,')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#       "createdDate": null,')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#       "createdBy": "unknown"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#     },")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#     {")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#       "id": 18,')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#       "ledgerAccountType": "SETTLEMENT",')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#       "currency": "USD",')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#       "isActive": 1,')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#       "createdDate": null,')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#       "createdBy": "unknown"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#     }")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#   ]")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# }")]),t._v("\n")])])]),e("p",[t._v("Check the output for the ledgerAccountType, and get the associated id. In my case, this is "),e("code",[t._v("18")]),t._v(".")]),t._v(" "),e("p",[t._v("Using the "),e("code",[t._v("settlementAccountId")]),t._v(", add some funds to the account:")]),t._v(" "),e("blockquote",[e("p",[t._v("Note: you can make up your own transferId, just make sure it follows the same format!")])]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -X POST http://beta.moja-lab.live/api/admin/central-ledger/participants/lewbank/accounts/18 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type: application/json'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    -d "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{\n          "transferId": "387ee6b9-520d-4c51-a9e4-6eb2ef15887d",\n          "externalReference": "n/a",\n          "action": "recordFundsIn",\n          "reason": "dfsp setup",\n          "amount": {\n            "amount": 5000,\n            "currency": "USD"\n          }\n        }\'')]),t._v("\n")])])]),e("h2",{attrs:{id:"_5-register-your-endpoints"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-register-your-endpoints"}},[t._v("#")]),t._v(" 5. Register your endpoints")]),t._v(" "),e("p",[t._v("In order to recieve callbacks from the switch, we need to register our endpoints. Feel free to copy and paste the following script into a text editor to easily configure the environment variables.")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("DFSP_ID")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("lewbank "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# your DFSP_ID you selected earlier")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("MOCK_SERVER_URL")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("https://thin-mole-36.loca.lt "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# or whatever your localtunnel prints out")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("ENDPOINTS_URL")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("http://beta.moja-lab.live/api/admin/central-ledger/participants/"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${DFSP_ID}")]),t._v("/endpoints\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -X POST "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type: application/json'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${ENDPOINTS_URL}")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -d "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{"type": "FSPIOP_CALLBACK_URL_PARTICIPANT_PUT", "value": "\'')]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$MOCK_SERVER_URL")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/participants/{{partyIdType}}/{{partyIdentifier}}\"}'")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -X POST "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type: application/json'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${ENDPOINTS_URL}")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -d "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{"type": "FSPIOP_CALLBACK_URL_PARTICIPANT_PUT_ERROR", "value": "\'')]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$MOCK_SERVER_URL")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/participants/{{partyIdType}}/{{partyIdentifier}}/error\"}'")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -X POST "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type: application/json'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${ENDPOINTS_URL}")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -d "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{"type": "FSPIOP_CALLBACK_URL_QUOTES", "value": "\'')]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$MOCK_SERVER_URL")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\"}'")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -X POST "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type: application/json'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${ENDPOINTS_URL}")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -d "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{"type": "FSPIOP_CALLBACK_URL_TRANSFER_POST", "value": "\'')]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$MOCK_SERVER_URL")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/transfers\"}'")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -X POST "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type: application/json'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${ENDPOINTS_URL}")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -d "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{"type": "FSPIOP_CALLBACK_URL_TRANSFER_PUT", "value": "\'')]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$MOCK_SERVER_URL")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/transfers/{{transferId}}\"}'")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -X POST "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type: application/json'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${ENDPOINTS_URL}")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -d "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{"type": "FSPIOP_CALLBACK_URL_TRANSFER_ERROR", "value": "\'')]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$MOCK_SERVER_URL")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/transfers/{{transferId}}/error\"}'")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -X POST "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type: application/json'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${ENDPOINTS_URL}")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -d "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{"type": "FSPIOP_CALLBACK_URL_AUTHORIZATIONS", "value": "\'')]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$MOCK_SERVER_URL")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\"}'")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -X POST "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type: application/json'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${ENDPOINTS_URL}")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -d "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{"type": "FSPIOP_CALLBACK_URL_TRX_REQ_SERVICE", "value": "\'')]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$MOCK_SERVER_URL")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\"}'")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -X POST "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type: application/json'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${ENDPOINTS_URL}")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -d "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{"type":"FSPIOP_CALLBACK_URL_AUTHORIZATIONS", "value":"\'')]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$MOCK_SERVER_URL")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\"}'")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -X POST "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type: application/json'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${ENDPOINTS_URL}")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -d "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{"type":"FSPIOP_CALLBACK_URL_PARTIES_GET", "value":"\'')]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$MOCK_SERVER_URL")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/parties/{{partyIdType}}/{{partyIdentifier}}\"}'")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -X POST "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type: application/json'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${ENDPOINTS_URL}")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -d "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{"type":"FSPIOP_CALLBACK_URL_PARTIES_PUT", "value":"\'')]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$MOCK_SERVER_URL")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/parties/{{partyIdType}}/{{partyIdentifier}}\"}'")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -X POST "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type: application/json'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${ENDPOINTS_URL}")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -d "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{"type":"FSPIOP_CALLBACK_URL_PARTIES_PUT_ERROR", "value":"\'')]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$MOCK_SERVER_URL")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/parties/{{partyIdType}}/{{partyIdentifier}}/error\"}'")]),t._v("\n\n")])])]),e("p",[t._v("Once you have registered all of the above endpoints, you can confirm that all of your endpoints were registered sucessfully:")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type: application/json'")]),t._v(" http://beta.moja-lab.live/api/admin/central-ledger/participants/lewbank/endpoints "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" jq\n")])])]),e("h2",{attrs:{id:"_6-perform-a-party-lookup-and-check-the-docker-logs"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-perform-a-party-lookup-and-check-the-docker-logs"}},[t._v("#")]),t._v(" 6. Perform a Party Lookup and Check the Docker Logs:")]),t._v(" "),e("p",[t._v("Now that you have registered your mock server with the Mojaloop switch, you can perform a party lookup using the Mojaloop "),e("RouterLink",{attrs:{to:"/2-apis/fspiop/"}},[t._v("FSPIOP API")]),t._v(".")],1),t._v(" "),e("p",[t._v("You can look up any of the pre-registered parties in "),e("RouterLink",{attrs:{to:"/1-overview/#users"}},[t._v("this list of users")]),t._v(". For this example, let's lookup "),e("code",[t._v("MSISDN/4448483173")]),t._v(", who we should expect to belong to "),e("code",[t._v("duriantech")]),t._v(", and have a name of "),e("code",[t._v("Draco Dragon")]),t._v(".")],1),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -v beta.moja-lab.live/api/fspiop/parties/MSISDN/4448483173 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Accept: application/vnd.interoperability.parties+json;version=1'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type: application/vnd.interoperability.parties+json;version=1.0'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'FSPIOP-Source: lewbank'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Date: 2021-01-01'")]),t._v("\n")])])]),e("p",[t._v("The synchonous response to our HTTP request should be "),e("code",[t._v("202 Accepted")]),t._v(". This means that Mojaloop accepted the request, and will get back to us with an async callback. For example:")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("$ curl -v beta.moja-lab.live/api/fspiop/parties/MSISDN/4448483173 \\\n  -H 'Accept: application/vnd.interoperability.parties+json;version=1' \\\n  -H 'Content-Type: application/vnd.interoperability.parties+json;version=1.0' \\\n  -H 'FSPIOP-Source: lewbank' \\\n  -H 'Date: 2021-01-01'\n*   Trying 3.11.229.205:80...\n* Connected to beta.moja-lab.live (3.11.229.205) port 80 (#0)\n> GET /api/fspiop/parties/MSISDN/4448483173 HTTP/1.1\n> Host: beta.moja-lab.live\n> User-Agent: curl/7.74.0\n> Accept: application/vnd.interoperability.parties+json;version=1\n> Content-Type: application/vnd.interoperability.parties+json;version=1.0\n> FSPIOP-Source: lewbank\n> Date: 2021-01-01\n> \n* Mark bundle as not supporting multiuse\n< HTTP/1.1 202 Accepted\n< Content-Length: 0\n< Connection: keep-alive\n< cache-control: no-cache\n< Date: Wed, 17 Feb 2021 03:08:51 GMT\n< X-Kong-Upstream-Latency: 17\n< X-Kong-Proxy-Latency: 0\n< Via: kong/2.2.1\n< \n* Connection #0 to host beta.moja-lab.live left intact\n")])])]),e("p",[t._v("And when we check the logs in the mock server docker container, we should see something like the following:")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('{\n    "path": "/parties/MSISDN/4448483173",\n    "headers": {\n        "user-agent": "axios/0.20.0",\n        "fspiop-signature": "{\\"signature\\":\\"XNjqPHPwVCFbjuUpndN4-udYBF-gY1Rmwau3QfFTZW-rIbHeMV6NIwdoTmR86X2IZOCd14Gu3SRBuo_k80A3heiMiOL5OIx-VKD4gnLYSog4W3xMLbWoN7kdNQb_K7Y2949uBEDYk2kR8q-k4IdlMO28WyIIwHxRRmb0bsyBuH2Tq5scH4nprorHx25_r41CBBr6u7GbSw5qmxFXEonE3wMmGsyxmNgEVDASnm9VISjAD4CyJ-VT-ZUEWp6ytJWpaNNRlAJL3CUvuB4LXyhiw0Zm_ozy8R70CyHNNlOjvw4qKgiB-O0UYBW7k6EXEmf0TTN1WaUJqktfVNuoEF0SFQ\\",\\"protectedHeader\\":\\"eyJhbGciOiJSUzI1NiIsIkZTUElPUC1VUkkiOiIvcGFydGllcy9NU0lTRE4vNDQ0ODQ4MzE3MyIsIkZTUElPUC1IVFRQLU1ldGhvZCI6IlBVVCIsIkZTUElPUC1Tb3VyY2UiOiJkdXJpYW50ZWNoIiwiRlNQSU9QLURlc3RpbmF0aW9uIjoibGV3YmFuayIsIkRhdGUiOiJXZWQsIDE3IEZlYiAyMDIxIDAzOjEwOjU2IEdNVCJ9\\"}",\n        "fspiop-uri": "/parties/MSISDN/4448483173",\n        "fspiop-http-method": "PUT",\n        "fspiop-destination": "lewbank",\n        "fspiop-source": "duriantech",\n        "date": "Wed, 17 Feb 2021 03:10:56 GMT",\n        "x-forwarded-path": "/api/fspiop/parties/MSISDN/4448483173",\n        "x-forwarded-port": "80,80",\n        "x-forwarded-host": "beta.moja-lab.live",\n        "content-type": "application/vnd.interoperability.parties+json;version=1.0",\n        "content-length": "241",\n        "connection": "close",\n        "x-nginx-proxy": "true",\n        "x-forwarded-proto": "https,http",\n        "host": "swift-fish-87.loca.lt",\n        "x-forwarded-for": "10.42.6.0, 3.10.23.13,::ffff:10.42.154.6",\n        "x-real-ip": "3.10.23.13"\n    },\n    "method": "PUT",\n    "body": "{\\"party\\":{\\"partyIdInfo\\":{\\"partyIdType\\":\\"MSISDN\\",\\"partyIdentifier\\":\\"4448483173\\",\\"fspId\\":\\"duriantech\\"},\\"personalInfo\\":{\\"complexName\\":{\\"firstName\\":\\"Draco\\",\\"middleName\\":\\"D\\",\\"lastName\\":\\"Dragon\\"},\\"dateOfBirth\\":\\"1970-01-01\\"},\\"name\\":\\"Draco Dragon\\"}}",\n    "fresh": false,\n    "hostname": "beta.moja-lab.live",\n    "ip": "3.10.23.13",\n    "ips": [\n        "3.10.23.13",\n        "::ffff:10.42.154.6"\n    ],\n    "protocol": "https",\n    "query": {},\n    "subdomains": [\n        "beta"\n    ],\n    "xhr": false,\n    "os": {\n        "hostname": "60c01ee30978"\n    },\n    "connection": {}\n}\n\n')])])]),e("p",[t._v("So we can see that we are getting callbacks from the Mojaloop switch!")]),t._v(" "),e("p",[t._v("When we inspect the "),e("code",[t._v("body")]),t._v(" field of the request, we can indeed see")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("Draco Dragon")]),t._v(" is the name of the party")]),t._v(" "),e("li",[t._v("The Callback came from a "),e("code",[t._v("FSPIOP-Source")]),t._v(" of "),e("code",[t._v("duriantech")])])]),t._v(" "),e("h2",{attrs:{id:"_7-next-steps"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_7-next-steps"}},[t._v("#")]),t._v(" 7. Next Steps")]),t._v(" "),e("p",[t._v("Congratulations on getting here! You have successfully registered your DFSP and recieved callbacks from the Mojaloop Sandbox.")]),t._v(" "),e("p",[t._v("From here, you can:")]),t._v(" "),e("ol",[e("li",[e("RouterLink",{attrs:{to:"/3-guides/2_dfsp_p2p/"}},[t._v("Perform a Peer to Peer Transaction")])],1),t._v(" "),e("li",[e("RouterLink",{attrs:{to:"/2-apis/fspiop/"}},[t._v("Browse the FSPIOP API")])],1),t._v(" "),e("li",[e("RouterLink",{attrs:{to:"/3-guides/3_simulators/"}},[t._v("Access and use the DFSP simulator")])],1)])])}),[],!1,null,null,null);a.default=n.exports}}]);